# 系统监控指南

## 1. 关键监控指标

### 系统指标
- **CPU 使用率**：在负载下预期较高，但不应持续保持 100%。
- **内存使用**：关注泄漏。工作池限制并发，内存应保持稳定。
- **网络 I/O**：吞吐（MB/s）与包速率。

### 应用指标（可通过 Prometheus/日志解析实现）
- **工作池深度**：
    -   `HighPriorityQueue` 长度
    -   `NormalPriorityQueue` 长度
    -   告警：若队列已满（阻塞），需扩容 worker。
- **延迟**：
    -   P95 响应时间。
    -   目标：查询 < 100ms。
- **吞吐（QPS）**：
    -   每秒请求数。
- **错误率**：
    -   数据库连接错误。
    -   JSON 解析错误。

## 2. 日志
- **标准输出**：服务器将重要事件（新连接、错误）输出到 stdout。
- **日志轮转**：确保 stdout 被采集并进行轮转（例如通过 Docker logs 或 logrotate）。

## 3. 健康检查
- **TCP 端口检查**：监控 9090 端口是否接受连接。
- **HTTP 健康端点**（可选）：服务器在 9091 端口启动 HTTP 服务。可在 `service/http_server.go` 中添加 `/health` 端点以供负载均衡器使用。

## 4. 数据库监控
- **连接数**：监控活跃与空闲连接（最大配置：100）。
- **慢查询**：启用 MySQL 慢查询日志以定位未优化的 SQL。
